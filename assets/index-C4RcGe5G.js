(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const h of s)if(h.type==="childList")for(const r of h.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function i(s){const h={};return s.integrity&&(h.integrity=s.integrity),s.referrerPolicy&&(h.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?h.credentials="include":s.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function e(s){if(s.ep)return;s.ep=!0;const h=i(s);fetch(s.href,h)}})();function d(o,t){o.save(),o.beginPath(),t(o),o.closePath(),o.restore()}function n(o=1){return Math.PI*o}function p(o,t){return~~(Math.random()*(t-o))+o}function w(o){return o.sort(()=>.5-Math.random())}function f(o){return w(o)[0]}function m(o,t){return[...o].sort(()=>Math.random()-.5).slice(0,t)}function x(){document.body.animate({backgroundColor:"rgba(100, 0, 0, 0.9)"},{duration:100})}class c{constructor(t=1){this.x=0,this.y=0,this.base=t,this.direction="stationary"}zero(){this.set(0,0)}stationary(){this.zero()}set(t,i){this.x=t,this.y=i}right(){this.set(this.base,0),this.direction="right"}left(){this.set(-this.base,0),this.direction="left"}up(){this.set(0,-this.base),this.direction="up"}down(){this.set(0,this.base),this.direction="down"}random(){const i=["left","up","down","right"].filter(s=>s!=this.direction),e=f(i);return this.direction=e,this[e]()}}class u{constructor(){this.speed=new c(3),this.x=0,this.y=0,this.size=0,this.rotation=0}isCollidingWithGhostHead(t){const i=t.x-t.width/2,e=t.y,s=i-this.x,h=e-this.y;return Math.hypot(s,h)<=this.size+t.width/2}isCollidingWithGhostBody(t){const i=t.x-t.width,e=t.y,s=Math.max(i,Math.min(this.x,t.x)),h=Math.max(e,Math.min(this.y,e+t.height)),r=this.x-s,l=this.y-h;return Math.hypot(r,l)<=t.size}isCollidingWithGhost(t){return this.isCollidingWithGhostHead(t)||this.isCollidingWithGhostBody(t)}event(){window.addEventListener("keydown",t=>{const i=t.code;typeof this[`${i}Pressed`]=="function"&&this[`${i}Pressed`]()})}ArrowRightPressed(){this.rotation=0,this.speed.right()}ArrowLeftPressed(){this.rotation=n(),this.speed.left()}ArrowUpPressed(){this.rotation=-n(.5),this.speed.up()}ArrowDownPressed(){this.rotation=n(.5),this.speed.down()}draw(){}update(){this.tick(),this.draw()}tick(){this.x+=this.speed.x,this.y+=this.speed.y,this.bringBack()}bringBack(){(!this.width||!this.height)&&(this.width=this.height=this.size),this.x>innerWidth+this.width&&(this.x=-this.width),this.x<-this.width&&(this.x=innerWidth+this.width),this.y<-this.height&&(this.y=innerHeight+this.height),this.y>innerHeight+this.height&&(this.y=-this.height)}}class b extends u{constructor(t,i=4){super(),this.board=t.board,this.factor=i,this.speed.base=10,this.speed[t.speed.direction](),this.size=5,this.x=t.x,this.y=t.y,this.shootingTime=Date.now(),this.context=this.board.context}draw(){d(this.context,t=>{t.arc(this.x,this.y,this.size,0,n(2)),t.fillStyle="rgba(255, 255, 255, 1)",t.fill()})}isExpired(){return Date.now()-this.shootingTime>1e3}}class P extends u{constructor(t){super(),this.board=t,this.context=t.context,this.x=100,this.y=100,this.size=35,this.fraction=10,this.speed=new c(6),this.event()}stick(){this.speed.zero(),window.addEventListener("mousemove",t=>{this.x=t.x,this.y=t.y})}SpacePressed(){const t=new b(this);this.board.projectiles.push(t)}EnterPressed(){this.speed.x=0,this.speed.y=0}draw(){const t=n()/this.fraction+this.board.sinCounter(.2,8);d(this.context,i=>{i.translate(this.x,this.y),i.rotate(this.rotation),i.arc(0,0,this.size,-t,t,!0),i.lineTo(0,0),i.fillStyle="#ffeb3b",i.fill()})}}class a extends u{constructor({board:t,size:i=5}){super(),this.size=i,this.board=t,this.context=this.board.context,this.width=i*25,this.height=this.width*.7,this.average=(this.width+this.height)/2,this.x=innerWidth/2-this.width*2+this.width,this.y=innerHeight/2,this.opacity=1,this.color=`rgba(250, 178, 52, ${this.opacity})`,this.speed=new c(f([2,3,4,5])),this.speed.random()}isCircleCollidingWithHead(t){const i=this.x-t.x,e=this.y-t.y;return Math.sqrt(i*i+e*e)<t.size+this.width/2}rectangle(){return[[this.x-this.width,this.y-this.height/2],[this.x,this.y+this.height/2]]}updateColor(){this.color=`rgba(250, 178, 52, ${this.opacity})`}update(){this.updateColor(),super.update()}drawHead(t){t.fillStyle=this.color,t.arc(-this.width/2,0,this.width/2,0,n(),!0),t.fill()}drawBodyPath(t){const i=[.8*this.height,this.height],e=4;t.beginPath(),t.moveTo(-this.width,0),t.lineTo(-this.width,this.height);for(let s=0;s<e*2;s++){const h=-this.width+(s+1)*this.width/(e*2),r=Math.sin(Date.now()/200);s===e*2-1?t.lineTo(h,i[s%2]):t.lineTo(h+r,i[s%2])}t.lineTo(0,0),t.closePath()}drawBodyBase(t){t.beginPath(),t.fillStyle=this.color,t.fillRect(-this.width,0,this.width,this.height),t.closePath(),t.fill()}drawBody(t){t.save(),this.drawBodyPath(t),t.clip(),this.drawBodyBase(t),t.restore()}drawEyes(t){this.drawInnerEyes(t),this.drawOuterEyes(t)}drawOuterEyes(t){t.beginPath(),t.fillStyle="black",t.arc(-this.width/4,0,this.width/16,0,n(2)),t.arc(-this.width+this.width/4,0,this.width/16,0,n(2)),t.fill(),t.closePath()}drawInnerEyes(t){t.beginPath(),t.fillStyle="white",t.arc(-this.width/4,0,this.width/8,0,n(2)),t.arc(-this.width+this.width/4,0,this.width/8,0,n(2)),t.fill(),t.closePath()}draw(){d(this.context,t=>{t.translate(this.x,this.y),this.drawHead(t),this.drawBody(t),this.drawEyes(t)})}clone(t={}){return t.board=this.board,new this.constructor(t)}randomLocation(){this.x=p(0,window.innerWidth),this.y=p(0,window.innerHeight)}}class C extends a{constructor(t,i){super(t),this.prime=i}updateColor(){this.color=`rgb(228, 13, 25, ${this.opacity})`}}class z extends a{constructor(t){super(t)}updateColor(){this.color=`rgb(235, 145, 190, ${this.opacity})`}}class B extends a{constructor(t){super(t)}updateColor(){this.color=`rgb(87, 191, 204, ${this.opacity})`}}class G{constructor(t){this.value=0,this.board=t,this.context=this.board.context}draw(){d(this.context,t=>{t.fillStyle="white",t.font="30px Arial",t.textAlign="left",t.textBaseline="bottom",t.fillText(`Score: ${parseInt(this.value)}`,20,innerHeight-20)})}update(){this.draw()}add(t=1){this.value+=t}increase(t=1){return this.add(t)}decrease(t=1){this.value-=t}}class E{constructor(){this.counter=0,this.element=document.createElement("canvas"),this.context=this.element.getContext("2d"),this.element.width=innerWidth,this.element.height=innerHeight,this.projectiles=[],this.score=new G(this),this.pacman=new P(this),this.ghosts=w([new a({board:this}),new B({board:this}),new C({board:this}),new z({board:this})])}element(){return this.element}addElement(){document.body.appendChild(this.element)}clean(){this.context.clearRect(0,0,innerWidth,innerHeight)}sinCounter(t=1,i){return t*Math.sin(this.counter/i)}loop(){requestAnimationFrame(()=>{this.counter++,this.loop(),this.clean(),this.score.update();const t=new Set;for(let i=0;i<this.projectiles.length;i++){const e=this.projectiles[i];e.update();for(let s=0;s<this.ghosts.length;s++){const h=this.ghosts[s],r=e.isCollidingWithGhost(h),l=h.size===1;if(r&&!l&&(h.opacity-=.1,h.opacity<.4)){const g=(6-h.size)*3;this.score.add(4-h.size),this.spawn(h,g),this.ghosts.splice(this.ghosts.indexOf(h),1)}(e.isExpired()||r)&&t.add(i)}}this.projectiles=this.projectiles.filter((i,e)=>!t.has(e)),this.ghosts.forEach((i,e)=>{const s=i.size===1,h=this.pacman.isCollidingWithGhost(i);h&&s?(this.score.increase(4),this.ghosts.splice(e,1)):h&&!s&&(this.score.decrease(i.size/25),x()),i.update()}),this.counter%100===0&&m(this.ghosts,Math.ceil(this.ghosts.length/3)).forEach(i=>i.speed.random()),this.pacman.update()})}randomGhosts(t,i){return Array(i).fill().map(()=>{const e=Math.max(1,t.size-1),s=t.clone({size:e});return s.randomLocation(),s})}spawn(t,i=3){let e=this.randomGhosts(t,i);for(;e.map(s=>this.pacman.isCollidingWithGhost(s)).some(Boolean);)e=this.randomGhosts(t,i);this.ghosts=[...this.ghosts,...e]}}const y=new E;y.addElement();y.loop();
