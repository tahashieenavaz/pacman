(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function e(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}})();function a(h,t){h.save(),h.beginPath(),t(h),h.closePath(),h.restore()}function n(h=1){return Math.PI*h}function f(h,t){return~~(Math.random()*(t-h))+h}function m(h){return h.sort(()=>.5-Math.random())}function u(h){return m(h)[0]}function b(h,t){return[...h].sort(()=>Math.random()-.5).slice(0,t)}function x(){document.body.animate({backgroundColor:"rgba(100, 0, 0, 0.9)"},{duration:100})}class p{constructor(t=1){this.x=0,this.y=0,this.base=t,this.direction="stationary"}zero(){this.set(0,0)}stationary(){this.zero()}set(t,i){this.x=t,this.y=i}right(){this.set(this.base,0),this.direction="right"}left(){this.set(-this.base,0),this.direction="left"}up(){this.set(0,-this.base),this.direction="up"}down(){this.set(0,this.base),this.direction="down"}random(){const i=["left","up","down","right"].filter(s=>s!=this.direction),e=u(i);return this.direction=e,this[e]()}}class w{constructor(){this.speed=new p(3),this.x=0,this.y=0,this.size=0,this.rotation=0}isCollidingWithGhostHead(t){const i=t.x-t.width/2,e=t.y,s=i-this.x,o=e-this.y;return Math.hypot(s,o)<=this.size+t.width/2}isCollidingWithGhostBody(t){const i=t.x-t.width,e=t.y,s=Math.max(i,Math.min(this.x,t.x)),o=Math.max(e,Math.min(this.y,e+t.height)),r=this.x-s,d=this.y-o;return Math.hypot(r,d)<=t.size}isCollidingWithGhost(t){return this.isCollidingWithGhostHead(t)||this.isCollidingWithGhostBody(t)}event(){window.addEventListener("keydown",t=>{const i=t.code;typeof this[`${i}Pressed`]=="function"&&this[`${i}Pressed`]()})}ArrowRightPressed(){this.rotation=0,this.speed.right()}ArrowLeftPressed(){this.rotation=n(),this.speed.left()}ArrowUpPressed(){this.rotation=-n(.5),this.speed.up()}ArrowDownPressed(){this.rotation=n(.5),this.speed.down()}draw(){}update(){this.tick(),this.draw()}tick(){this.x+=this.speed.x,this.y+=this.speed.y,this.bringBack()}bringBack(){(!this.width||!this.height)&&(this.width=this.height=this.size),this.x>innerWidth+this.width&&(this.x=-this.width),this.x<-this.width&&(this.x=innerWidth+this.width),this.y<-this.height&&(this.y=innerHeight+this.height),this.y>innerHeight+this.height&&(this.y=-this.height)}}class P extends w{constructor(t,i=4){super(),this.board=t.board,this.factor=i,this.speed.base=10,this.speed[t.speed.direction](),this.size=5,this.x=t.x,this.y=t.y,this.shootingTime=Date.now(),this.context=this.board.context}draw(){a(this.context,t=>{t.arc(this.x,this.y,this.size,0,n(2)),t.fillStyle="rgba(255, 255, 255, 1)",t.fill()})}isExpired(){return Date.now()-this.shootingTime>1e3}}class v{constructor(t,i,e){this.board=t,this.context=this.board.context,this.x=i,this.y=e,this.plantingTime=Date.now(),this.bigSize=0,this.smallSize=0}draw(){a(this.context,t=>{t.beginPath(),t.fillStyle="#f9b64e",t.arc(this.x,this.y,this.bigSize,0,n(2)),t.fill(),t.closePath(),t.beginPath(),t.fillStyle="#cb353d",t.arc(this.x,this.y,this.smallSize,0,n(2)),t.fill(),t.closePath(),t.beginPath(),t.font="48px Arial",t.textAlign="center",t.fillText("ðŸ’£",this.x,this.y),t.closePath()})}update(){this.draw()}shouldDetonate(){return Date.now()-this.plantingTime>100}}class z extends w{constructor(t){super(),this.board=t,this.context=t.context,this.x=100,this.y=100,this.size=35,this.fraction=10,this.speed=new p(6);const i=u(["ArrowRightPressed","ArrowLeftPressed","ArrowUpPressed","ArrowDownPressed"]);this[i](),this.event()}stick(){this.speed.zero(),window.addEventListener("mousemove",t=>{this.x=t.x,this.y=t.y})}SpacePressed(){const t=new P(this);this.board.projectiles.push(t)}EnterPressed(){const t=new v(this.board,this.x,this.y);this.board.bombs.push(t)}draw(){const t=n()/this.fraction+this.board.sinCounter(.2,8);a(this.context,i=>{i.translate(this.x,this.y),i.rotate(this.rotation),i.arc(0,0,this.size,-t,t,!0),i.lineTo(0,0),i.fillStyle="#ffeb3b",i.fill()})}}class c extends w{constructor({board:t,size:i=5}){super(),this.size=i,this.board=t,this.context=this.board.context,this.width=i*25,this.height=this.width*.7,this.average=(this.width+this.height)/2,this.x=innerWidth/2-this.width*2+this.width,this.y=innerHeight/2,this.opacity=1,this.color=`rgba(250, 178, 52, ${this.opacity})`,this.speed=new p(u([2,3,4,5])),this.speed.random()}isCircleCollidingWithHead(t){const i=this.x-t.x,e=this.y-t.y;return Math.sqrt(i*i+e*e)<t.size+this.width/2}rectangle(){return[[this.x-this.width,this.y-this.height/2],[this.x,this.y+this.height/2]]}updateColor(){this.color=`rgba(250, 178, 52, ${this.opacity})`}update(){this.updateColor(),super.update()}drawHead(t){t.fillStyle=this.color,t.arc(-this.width/2,0,this.width/2,0,n(),!0),t.fill()}drawBodyPath(t){const i=[.8*this.height,this.height],e=4;t.beginPath(),t.moveTo(-this.width,0),t.lineTo(-this.width,this.height);for(let s=0;s<e*2;s++){const o=-this.width+(s+1)*this.width/(e*2),r=Math.sin(Date.now()/200);s===e*2-1?t.lineTo(o,i[s%2]):t.lineTo(o+r,i[s%2])}t.lineTo(0,0),t.closePath()}drawBodyBase(t){t.beginPath(),t.fillStyle=this.color,t.fillRect(-this.width,0,this.width,this.height),t.closePath(),t.fill()}drawBody(t){t.save(),this.drawBodyPath(t),t.clip(),this.drawBodyBase(t),t.restore()}drawEyes(t){this.drawInnerEyes(t),this.drawOuterEyes(t)}drawOuterEyes(t){t.beginPath(),t.fillStyle="black",t.arc(-this.width/4,0,this.width/16,0,n(2)),t.arc(-this.width+this.width/4,0,this.width/16,0,n(2)),t.fill(),t.closePath()}drawInnerEyes(t){t.beginPath(),t.fillStyle="white",t.arc(-this.width/4,0,this.width/8,0,n(2)),t.arc(-this.width+this.width/4,0,this.width/8,0,n(2)),t.fill(),t.closePath()}draw(){a(this.context,t=>{t.translate(this.x,this.y),this.drawHead(t),this.drawBody(t),this.drawEyes(t)})}clone(t={}){return t.board=this.board,new this.constructor(t)}randomLocation(){this.x=f(0,window.innerWidth),this.y=f(0,window.innerHeight)}}class E extends c{constructor(t,i){super(t),this.prime=i}updateColor(){this.color=`rgb(228, 13, 25, ${this.opacity})`}}class S extends c{constructor(t){super(t)}updateColor(){this.color=`rgb(235, 145, 190, ${this.opacity})`}}class G extends c{constructor(t){super(t)}updateColor(){this.color=`rgb(87, 191, 204, ${this.opacity})`}}class C{constructor(t){this.value=0,this.board=t,this.context=this.board.context}draw(){a(this.context,t=>{t.fillStyle="white",t.font="30px Arial",t.textAlign="left",t.textBaseline="bottom",t.fillText(`Score: ${parseInt(this.value)}`,20,innerHeight-20)})}update(){this.draw()}add(t=1){this.value+=t}increase(t=1){return this.add(t)}decrease(t=1){this.value-=t}}class B{constructor(){this.counter=0,this.createElement(),this.score=new C(this),this.pacman=new z(this),this.ghosts=m([new c({board:this}),new G({board:this}),new E({board:this}),new S({board:this})]),this.sounds={start:new Audio("sounds/pacman_beginning.wav"),chomp:new Audio("sounds/pacman_chomp.wav"),eat:new Audio("sounds/pacman_eatghost.wav")};for(let t in this.sounds)this.sounds[t].volume=.5;this.projectiles=[],this.bombs=[],this.animationId=null,this.isRunning=!1}playAudio(t){this.sounds[t].play()}play(){this.isRunning||(this.isRunning=!0,this.loop())}pause(){this.isRunning=!1,cancelAnimationFrame(this.animationId)}element(){return this.element}createElement(){this.element=document.createElement("canvas"),this.context=this.element.getContext("2d"),this.element.width=innerWidth,this.element.height=innerHeight}addElement(){document.body.appendChild(this.element)}removeElement(){document.body.removeElement(this.element)}clean(){this.context.clearRect(0,0,innerWidth,innerHeight)}sinCounter(t=1,i){return t*Math.sin(this.counter/i)}loop(t=!1){this.animationId=requestAnimationFrame(()=>{this.counter++,t||this.loop(),this.clean(),this.score.update(),this.updateProjectiles(),this.updateGhosts(),this.updateBombs(),this.randomizeGhostMovements(),this.pacman.update()})}randomizeGhostMovements(){this.counter%100===0&&b(this.ghosts,Math.ceil(this.ghosts.length/3)).forEach(t=>t.speed.random())}updateBombs(){this.bombs.forEach(t=>{t.smallSize+=1.5,t.bigSize+=2,t.update()})}updateGhosts(){this.ghosts.forEach((t,i)=>{const e=t.size===1,s=this.pacman.isCollidingWithGhost(t);s&&e?(this.score.increase(4),this.ghosts.splice(i,1)):s&&!e&&(this.score.decrease(t.size/20),x()),t.update()})}updateProjectiles(){const t=new Set;for(let i=0;i<this.projectiles.length;i++){const e=this.projectiles[i];e.update();for(let s=0;s<this.ghosts.length;s++){const o=this.ghosts[s],r=e.isCollidingWithGhost(o),d=o.size===1;if(r&&!d&&(o.opacity-=.1,o.opacity<.4)){const g=o.size===2?5:2;this.score.add(6-o.size),this.spawn(o,g),this.ghosts.splice(this.ghosts.indexOf(o),1)}(e.isExpired()||r)&&!d&&t.add(i)}}this.projectiles=this.projectiles.filter((i,e)=>!t.has(e))}randomGhosts(t,i){return Array(i).fill().map(()=>{const e=Math.max(1,t.size-1),s=t.clone({size:e});return s.randomLocation(),s})}spawn(t,i=3){let e=this.randomGhosts(t,i);for(;e.map(s=>this.pacman.isCollidingWithGhost(s)).some(Boolean);)e=this.randomGhosts(t,i);this.ghosts=[...this.ghosts,...e]}restart(){this.removeElement()}}const l=new B,A=document.querySelector("section");function y(){A.remove(),l.playAudio("start"),l.addElement(),l.loop(!0),l.loop(),window.removeEventListener("keydown",y)}window.addEventListener("keydown",y);
